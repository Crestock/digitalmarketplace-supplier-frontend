{% extends "govuk/govuk_template.html" %}

{% block head %}
    {% with custom_dimensions=[
          {"data_id": 11, "data_value": current_user.supplier_organisation_size }
      ] if current_user and current_user.supplier_organisation_size else []
    %}
      {% include "toolkit/custom-dimensions.html" %}
    {% endwith %}

  {% include "_stylesheets.html" %}
{% endblock %}

{% block cookie_message %}
  {% include "_cookie_message.html" %}
{% endblock %}

{% block header_class %}with-proposition{% endblock %}

{% block inside_header %}
  {% include "toolkit/inside-header.html" %}
{% endblock %}

{% block proposition_header %}
  {% include "toolkit/proposition-header.html" %}
{% endblock %}

{% block content %}
  {% block breadcrumb %}{% endblock %}
  <div id="wrapper">
    <main id="content" role="main">
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
            {% if category == 'track-page-view' %}
              <div data-analytics="trackPageView" data-url="{{ message }}"></div>
            {% elif category == 'flag' %}
              {# these were originally messages with a function similar to the above "track-page-view" ones (analytics) but #}
              {# they did not know about their actual virtual page view url, expecting the receiving page to know the       #}
              {# corresponding url for a particular symbolic "message".                                                     #}
              {# TODO these can be got rid of as soon as the app generating each flag flash message is converted to using   #}
              {# new "track-page-view" mechanism                                                                            #}
              {% if message == "account-created" %}
                <div data-analytics="trackPageView" data-url="/suppliers?account-created=true"></div>
              {% endif %}
              {# else we don't know about this particular flag-message so shouldn't try to do anything about it #}
            {% elif category != 'must_login' %}  {# skip showing Flask's "Please log in" message #}
              <div class="flash-message-container {{ 'banner-destructive-without-action' if category == 'error' else 'banner-success-without-action' }}">
                <p class="banner-message">
                  {# TODO remove the below special cases, once those two apps have been updated to contain the message. #}
                  {% if message == 'supplier-role-required' %}  {# set by supplier app #}
                    You must log in with a supplier account to see this page.

                  {% elif message == 'buyer-role-required' %}  {# set by briefs app #}
                    You must log in with a buyer account to see this page.

                  {% else %}
                    {{ message }}

                  {% endif %}
                </p>
              </div>
            {% endif %}
          {% endfor %}
        {% endif %}
      {% endwith %}

      {% block main_content %}
      {% endblock %}
    </main>
  </div>
{% endblock %}

{% block footer_top %}
  {% include "_footer_categories.html" %}
{% endblock %}

{% block footer_support_links %}
  <h2 class="visuallyhidden">Support links</h2>
    <ul>
        <li><a href="/terms-and-conditions" class="terms-and-conditions">Terms and conditions</a></li>
        <li><a href="/cookies">Cookies</a></li>
        <li>Built by the <a href="https://www.gov.uk/government/organisations/government-digital-service">Government Digital Service</a></li>
    </ul>
{% endblock %}

{% block body_end %}
  {% include "_javascripts.html" %}
  {% block page_scripts %}{% endblock %}
{% endblock %}
