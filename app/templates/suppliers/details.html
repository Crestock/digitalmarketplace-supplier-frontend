{% extends "_base_page.html" %}
{% import "toolkit/summary-table.html" as summary %}
{% block page_title %}Supplier details â€“ Digital Marketplace{% endblock %}

{% block breadcrumb %}
  {%
    with items = [
      {
        "link": "/",
        "label": "Digital Marketplace"
      },
      {
        "link": url_for(".dashboard"),
        "label": "Your account"
      }
    ]
  %}
    {% include "toolkit/breadcrumb.html" %}
  {% endwith %}
{% endblock %}


{% block main_content %}
{%
  with
    heading = "Company details",
    smaller = true
%}
  {% include "toolkit/page-heading.html" %}
{% endwith %}

{{ summary.heading("What buyers will see", id="what_buyers_will_see") }}
{{ summary.top_link('Change', url_for('.edit_supplier')) }}
{% call(item) summary.mapping_table(
  caption='What buyers will see',
  field_headings=[
    'Label',
    'Value',
    'Optional'
  ],
  field_headings_visible=False
) %}
  {% call summary.row() %}
    {{ summary.field_name('Contact name') }}
    {{ summary.text(supplier.contact.contactName) }}
    {{ summary.text("") }}
  {% endcall %}
  {% call summary.row() %}
    {{ summary.field_name('Contact email') }}
    {{ summary.text(supplier.contact.email) }}
    {{ summary.text("") }}
  {% endcall %}
  {% call summary.row() %}
    {{ summary.field_name('Contact phone number') }}
    {{ summary.text(supplier.contact.phoneNumber) }}
    {{ summary.text("") }}
  {% endcall %}
  {% call summary.row() %}
    {{ summary.field_name('Summary') }}
    {{ summary.text(supplier.description) }}
    {% call summary.field(action=True) %}
      <span class="hint" style="font-size: 16px; margin: 0; padding: 0; padding-right: 20px;">Optional</span>
    {% endcall %}
  {% endcall %}
{% endcall %}

{{ summary.heading("Company details for your framework applications", id="registration_information") }}
{% call(item) summary.mapping_table(
  caption='Registration information',
  field_headings=[
    'Label',
    'Value'
  ],
  field_headings_visible=False
) %}

{% call summary.row() %}
  {{ summary.field_name('Registered company name') }}
  {% if supplier.registeredName %}
    {{ summary.text(supplier.registeredName) }}
  {% else %}
    {{ summary.link(link_title="Answer required", link="#") }}
  {% endif %}
{% endcall %}

  {% call summary.row() %}
    {{ summary.field_name('Registered office address') }}
    {% set postcode = supplier.contact.get("postcode") %}
    {% set street_address_line_1 = supplier.contact.get("address1") %}
    {% set locality = supplier.contact.get("city") %}
    {% if postcode and street_address_line_1 and locality %}
      {% call summary.field() %}
        {%
          with
          without_spacing = true,
          postcode = postcode,
          street_address = True,
          street_address_line_1 = street_address_line_1,
          locality = locality
        %}
          {% include "toolkit/contact-details.html" %}
        {% endwith %}
      {% endcall %}
    {% else %}
      {{ summary.link(link_title="Answer required", link="#") }}
    {% endif %}
  {% endcall %}

  {% if supplier.companiesHouseNumber %}
    {% call summary.row() %}
      {{ summary.field_name('Companies House number') }}
      {{ summary.text(supplier.companiesHouseNumber) }}
    {% endcall %}
  {% endif %}

  {% if supplier.registrationCountry and not supplier.companiesHouseNumber %}
    {% call summary.row() %}
      {{ summary.field_name('Where your business was established') }}
      {{ summary.text(country_name) }}
    {% endcall %}
  {% endif %}

  {% if supplier.otherCompanyRegistrationNumber and not supplier.companiesHouseNumber and country_name != 'United Kingdom' %}
    {% call summary.row() %}
      {{ summary.field_name('Registration number') }}
      {{ summary.text(supplier.otherCompanyRegistrationNumber) }}
    {% endcall %}
  {% endif %}

  {% if supplier.dunsNumber %}
    {% call summary.row() %}
      {{ summary.field_name('DUNS number') }}
      {{ summary.text(supplier.dunsNumber) }}
    {% endcall %}
  {% endif %}

  {% if supplier.vatNumber %}
    {% call summary.row() %}
      {{ summary.field_name('VAT number') }}
      {{ summary.text(supplier.vatNumber) }}
    {% endcall %}
  {% endif %}

  {% if supplier.tradingStatus %}
    {% call summary.row() %}
      {{ summary.field_name('Trading status') }}
      {{ summary.text(supplier.tradingStatus|capitalize_first) }}
    {% endcall %}
  {% endif %}

  {% if supplier.organisationSize %}
    {% call summary.row() %}
      {{ summary.field_name('Company size') }}
      {{ summary.text(supplier.organisationSize|capitalize_first) }}
    {% endcall %}
  {% endif %}

{% endcall %}
{% endblock %}
